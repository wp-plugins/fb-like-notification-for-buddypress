function bfln_check_notifications(){if(BFLN_.doingajax||BFLN_.iscurrent_tab_active){t=setTimeout(bfln_check_notifications,BFLN_.time);return false}var e={action:BFLN_.action,nonce:BFLN_.nonce};BFLN_.doingajax=true;jq.ajax({type:"POST",url:ajaxurl,data:e,success:function(e){bfln_after_get_new_notification(e);BFLN_.doingajax=false;if(BFLN_.debug)console.log("ajax request completed, aborting")}});t=setTimeout(bfln_check_notifications,BFLN_.time)}function bfln_after_get_new_notification(e){var t=e.lastIndexOf("}");if(t!=-1){var e=e.substring(0,t+1)}var n=jq.parseJSON(e);if(n.count>0){bfln_notification_html(n.notifications)}}function bfln_notification_html(e){if(typeof e=="undefined"||e==""){return false}var t=0;for(i=0;i<e.length;i++){var n=e[i].id;if(typeof n!="undefined"&&n!=null){var r=false;var s=false;for(j=0;j<BFLN_.cached_notf_ids.length;j++){if(BFLN_.debug)console.log("matching new : "+n+" and old : "+BFLN_.cached_notf_ids[j][0]);if(n==BFLN_.cached_notf_ids[j][0]){if(e[i].content!=BFLN_.cached_notf_ids[j][1]){if(BFLN_.debug)console.log("old id "+n+" but updated text");s=true;BFLN_.cached_notf_ids[j][1]=e[i].content;jq("#"+BFLN_.sm_ulid+" > li#wp-admin-bar-notification-"+n+" > a").html(e[i].content);textChangedAt=j;break}else{r=true;break}}}if(s==true){t++}else{if(!r){BFLN_.cached_notf_ids.push(new Array(n,e[i].content));var o="<li id='wp-admin-bar-notification-"+e[i].id+"' class=''>";o+="<a class='ab-item' href='"+e[i].href+"'>"+e[i].content+"</a>";o+="</li>";jq("#"+BFLN_.top_parent+" #"+BFLN_.sm_ulid).append(o);t++}}}}if(t>0){var u=BFLN_.newnotification*1+t*1;BFLN_.newdoctitle="("+u+") "+BFLN_.doctitle;BFLN_.newnotification=u;BFLN_.stop_blinking=false;bfln_blink_browser_title();jq("#ab-pending-notifications").html(u);if(jq("#ab-pending-notifications").hasClass("no-alert")){jq("#ab-pending-notifications").removeClass("no-alert").removeClass("count").addClass("pending-count").addClass("alert")}jq("#wp-admin-bar-no-notifications").remove()}}function bfln_blink_browser_title(){if(!BFLN_.stop_blinking){if(document.title==BFLN_.doctitle&&BFLN_.newdoctitle!=""){document.title=BFLN_.newdoctitle}else{document.title=BFLN_.doctitle}}setTimeout(bfln_blink_browser_title,120)}var jq=jQuery.noConflict();jq(function(){BFLN_.debug=false;BFLN_.stop_blinking=true;BFLN_.doingajax=false;BFLN_.iscurrent_tab_active=true;BFLN_.cached_notf_ids=new Array;BFLN_.top_parent="wp-admin-bar-bp-notifications";BFLN_.sm_ulid="wp-admin-bar-bp-notifications-default";jq("#"+BFLN_.top_parent+" #"+BFLN_.sm_ulid+" > li").each(function(){var e=jq(this).attr("id");if(typeof e=="undefined"||e==null)return;var t=e.split("-");var n=t[t.length-1];if(typeof n=="undefined"||n==null||isNaN(n))return;BFLN_.cached_notf_ids.push(new Array(n,jq(this).find(">a").html()))});if(BFLN_.doctitle==""){BFLN_.doctitle=document.title}window.onfocus=function(){BFLN_.iscurrent_tab_active=true;BFLN_.stop_blinking=true};window.onblur=function(){BFLN_.iscurrent_tab_active=false};t=setTimeout(bfln_check_notifications,BFLN_.time)})